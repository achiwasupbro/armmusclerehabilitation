<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡πÅ‡∏Ç‡∏ô</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1 id="mainTitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡πÅ‡∏Ç‡∏ô</h1>
            <p class="subtitle" id="subtitle">‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà IP ‡πÄ‡∏≠‡∏á</p>
            <button id="langToggle" class="btn btn-lang">üåê TH</button>
        </header>

        <div class="discovery-section">
            <button id="scanBtn" class="btn btn-primary">
                <span class="btn-icon">üîç</span>
                <span id="scanBtnText">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ESP32 ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</span>
            </button>
            <button id="skipBtn" class="btn btn-skip">
                <span class="btn-icon">‚è≠Ô∏è</span>
                <span id="skipBtnText">‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡∏ó‡∏î‡∏™‡∏≠‡∏ö (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏≠‡∏£‡πå‡∏î)</span>
            </button>
            <div id="scanStatus" class="status"></div>
        </div>

        <div id="devicesList" class="devices-list"></div>

        <div id="deviceControl" class="device-control hidden">
            <h2 id="deviceControlTitle">‡πÄ‡∏à‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏†‡∏≤‡∏û‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÅ‡∏Ç‡∏ô‡πÅ‡∏•‡πâ‡∏ß</h2>
            <div class="device-info">
                <p><strong id="deviceNameLabel">‡∏ä‡∏∑‡πà‡∏≠:</strong> <span id="deviceName"></span></p>
                <p><strong id="deviceAddressLabel">Address:</strong> <span id="deviceIP"></span></p>
                <p><strong id="deviceStatusLabel">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> <span id="deviceStatus" class="status-badge">-</span></p>
            </div>
            
            <div class="arm-selection">
                <h3 id="armSelectionTitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏Ç‡∏ô</h3>
                <div class="arm-buttons">
                    <button class="btn btn-arm" data-arm="right">
                        <span class="arm-icon">üëâ</span>
                        <span class="arm-label" id="rightArmLabel">‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤</span>
                    </button>
                    <button class="btn btn-arm" data-arm="left">
                        <span class="arm-icon">üëà</span>
                        <span class="arm-label" id="leftArmLabel">‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢</span>
                    </button>
                </div>
            </div>

            <div class="mode-control">
                <h3 id="modeControlTitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î</h3>
                <div class="mode-buttons">
                    <button class="btn btn-mode" data-mode="1">
                        <span class="mode-number">1</span>
                        <span class="mode-label mode-label-1">‡πÇ‡∏´‡∏°‡∏î 1</span>
                    </button>
                    <button class="btn btn-mode" data-mode="2">
                        <span class="mode-number">2</span>
                        <span class="mode-label mode-label-2">‡πÇ‡∏´‡∏°‡∏î 2</span>
                    </button>
                    <button class="btn btn-mode" data-mode="3">
                        <span class="mode-number">3</span>
                        <span class="mode-label mode-label-3">‡πÇ‡∏´‡∏°‡∏î 3</span>
                    </button>
                    <button class="btn btn-mode" data-mode="4">
                        <span class="mode-number">4</span>
                        <span class="mode-label mode-label-4">‡πÇ‡∏´‡∏°‡∏î 4</span>
                    </button>
                    <button class="btn btn-mode" data-mode="5">
                        <span class="mode-number">5</span>
                        <span class="mode-label mode-label-5">‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</span>
                    </button>
                </div>
                <div id="modeStatus" class="mode-status"></div>
                <div id="progressStatus" class="progress-status"></div>
            </div>

            <div class="voice-control">
                <h3 id="voiceControlTitle">üé§ ‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á</h3>
                <button id="startVoiceBtn" class="btn btn-voice">
                    <span class="btn-icon">üé§</span>
                    <span id="startVoiceBtnText">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</span>
                </button>
                <button id="stopVoiceBtn" class="btn btn-voice hidden">
                    <span class="btn-icon">‚èπÔ∏è</span>
                    <span id="stopVoiceBtnText">‡∏´‡∏¢‡∏∏‡∏î‡∏ü‡∏±‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</span>
                </button>
                <div id="voiceStatus" class="voice-status"></div>
            </div>

            <div class="camera-control">
                <h3 id="cameraControlTitle">ü§ñ AI ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ô‡∏¥‡πâ‡∏ß‡∏°‡∏∑‡∏≠</h3>
                <div id="mediapipeStatus" style="padding: 10px; margin-bottom: 10px; border-radius: 8px; font-size: 0.9rem;"></div>
                <button id="startCameraBtn" class="btn btn-camera">
                    <span class="btn-icon">üì∑</span>
                    <span id="startCameraBtnText">‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</span>
                </button>
                <button id="stopCameraBtn" class="btn btn-camera hidden">
                    <span class="btn-icon">‚èπÔ∏è</span>
                    <span id="stopCameraBtnText">‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</span>
                </button>
                <div class="camera-container">
                    <video id="videoElement" class="camera-video" autoplay playsinline></video>
                    <canvas id="canvasElement" class="camera-canvas"></canvas>
                    <div id="fingerCount" class="finger-count">0 ‡∏ô‡∏¥‡πâ‡∏ß</div>
                    <div id="countdown" class="countdown"></div>
                </div>
                <div id="gestureStatus" class="gesture-status"></div>
            </div>
        </div>
    </div>
    <script src="language.js"></script>
    <script src="handgesture.js"></script>
    <script src="app.js"></script>
    
    <script>
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ MediaPipe ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    window.addEventListener('load', () => {
        const statusDiv = document.getElementById('mediapipeStatus');
        const startBtn = document.getElementById('startCameraBtn');
        
        // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏Å‡πà‡∏≠‡∏ô
        function checkMediaPipe() {
            if (typeof Hands === 'undefined' || typeof Camera === 'undefined') {
                console.error('‚ùå MediaPipe ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î...');
                if (statusDiv) {
                    statusDiv.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î AI ‡∏Å‡∏•‡πâ‡∏≠‡∏á... (‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ 5-10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)';
                    statusDiv.style.background = '#fff3cd';
                    statusDiv.style.color = '#856404';
                }
                if (startBtn) {
                    startBtn.disabled = true;
                    startBtn.style.opacity = '0.5';
                }
                return false;
            } else {
                console.log('‚úÖ MediaPipe ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                if (statusDiv) {
                    statusDiv.innerHTML = '‚úÖ ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                    statusDiv.style.background = '#d4edda';
                    statusDiv.style.color = '#155724';
                }
                if (startBtn) {
                    startBtn.disabled = false;
                    startBtn.style.opacity = '1';
                }
                return true;
            }
        }
        
        // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏∏‡∏Å 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        let attempts = 0;
        const maxAttempts = 15;
        const checkInterval = setInterval(() => {
            attempts++;
            if (checkMediaPipe()) {
                clearInterval(checkInterval);
            } else if (attempts >= maxAttempts) {
                clearInterval(checkInterval);
                console.error('‚ùå MediaPipe ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                if (statusDiv) {
                    statusDiv.innerHTML = '‚ùå AI ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à<br><small>‡∏•‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï</small>';
                    statusDiv.style.background = '#f8d7da';
                    statusDiv.style.color = '#721c24';
                }
            }
        }, 1000);
    });
    </script>
</body>
</html>

